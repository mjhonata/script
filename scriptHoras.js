javascript: var ok = function () { console.warn("rodando - extração v1.1"); var nomes = ["Alexandre Americo Fumes", "Anderson Junior Rodrigues", "Andre Nascimento Costa", "Andre Parente e Silva Bonnano", "Arthur Lorenzetti da Rosa", "Guilherme da Silva Barbarino", "Gustavo Nascimento Costa", "Jorge Luis dos Santos Leal", "Matheus de Paula Rodrigues", "Pedro Henrique Silva Gusmao", "Rodrigo Naoto Maeda"]; var userId, username, totalHours, buscar, sizeNames, resu = [["extracao", "nome", "total"]], resultado, dt = new Date; var padL = (nr, len = 2, chr = `0`) => `${nr}`.padStart(2, chr); var extraction_date = `${padL(dt.getDate())}/${padL(dt.getMonth() + 1)}/${dt.getFullYear()} ${padL(dt.getHours())}:${padL(dt.getMinutes())}:${padL(dt.getSeconds())}`; resultado = { 'extraction_date': extraction_date, content: [] }; async function extrair() { totalHours = document.querySelector("#tabela > table > tfoot > tr > td.info-task-fixed.fixed-col-3.info-task-header.ng-binding").textContent; if (totalHours == "next") { await new Promise(r => setTimeout(r, 1000)); await extrair(); } else { document.querySelector("#tabela > table > tfoot > tr > td.info-task-fixed.fixed-col-3.info-task-header.ng-binding").textContent = 'next'; resultado.content.push({ userId: userId, username: username, total: totalHours }); resu.push([extraction_date, username, parseInt(totalHours)]); } }; function baixar() { alert('Relatório extraído com sucesso! \nclique em ok para abrir um pop-up e salvar o arquivo'); $("#baixarExtracao").remove(); var nameDt = % 60${ padL(dt.getMonth() + 1) } -${ dt.getFullYear() }% 60; var csvContent = encodeURI("data:text/csv;charset=utf-8," + resu.map(e => e.join(",")).join("\n")); buscar.after(% 60 < div > </br > <a id="baixarExtracao" href=${csvContent} download="RelatorioHoras-${nameDt}.csv"><strong> > Download RelatorioHoras-${nameDt}.csv </strong> </a> </div > % 60); $("#baixarExtracao").get(0).click(); }; async function relatorio() { document.querySelector("#tabela > table > tfoot > tr > td.info-task-fixed.fixed-col-3.info-task-header.ng-binding").textContent = 'next'; buscar = $(".btn-primary").filter(function () { return $(this).text() == "Buscar"; }); sizeNames = nomes.length; for (const name of nomes) { userId = ""; $('select[title="Usuario"] option').filter(function () { if ($(this).text() == name.toUpperCase()) { userId = $(this).val(); username = $(this).text(); return true; } }); if (userId) { $('select[title="Usuario"]').val(userId).change(); buscar.click(); await new Promise(r => setTimeout(r, 1000)); await extrair(); } }; baixar(); }; relatorio();}; ok();